<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <title>Cryptography toolbox</title>
</head>
<body>
<h1 class="h1 text-center">Cryptography toolbox</h1>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-4">
            <div class="card text-dark bg-light mb-3 border-dark">
                <div class="card-header">
                    Longest word finder
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label for="longest-word-ta" class="form-label">Text to check</label>
                        <textarea class="form-control textarea pb-2" id="longest-word-ta"
                                  aria-describedby="longest-ta-Help" rows="10"></textarea>
                        <div id="longest-ta-Help" class="form-text">Copy the text to check here</div>
                    </div>
                    <button type="button" id="longest-word-ta-btn" class="btn btn-primary">Check</button>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            <div class="card text-dark bg-light mb-3 border-dark">
                <div class="card-header">
                    Results
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label for="longest-word-results-ta" class="form-label">Words found</label>
                        <div class="" id="longest-word-results-ta">
                            <p id="words-list">
                                <table id="words-table" class="table">
                                    <thead>
                                        <tr>
                                            <th>Word</th>
                                            <th>Length</th>
                                            <th>Pattern</th>
                                        </tr>
                                    </thead>
                                    <tbody id="words-table-content">
                                    </tbody>
                                </table>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
<script src="dictionary.js"></script>
</body>

<script>
    let longestWordText = null;
    let words = [];

    $(function () {
        $('#longest-word-ta-btn').prop('disabled', true);
    });

    $('#longest-word-ta-btn').on('click', function () {
        longestWordText = $('#longest-word-ta').val();
        removePunctuation();
        longestWord();
    });

    $('#longest-word-ta').bind('paste keydown', function (e) {

        let eventType = e.type;
        if (eventType === 'paste') {
            longestWordText = e.originalEvent.clipboardData.getData('text');
        } else {
            longestWordText = $('#longest-word-ta').val();
        }
        if (longestWordText.length > 1) {
            $('#longest-word-ta-btn').prop('disabled', false);

        } else {
            $('#longest-word-ta-btn').prop('disabled', true);
        }
    });

    function removePunctuation() {
        let punctuationless = longestWordText.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, "");
        longestWordText = punctuationless.replace(/\s{2,}/g, " ");
    }

    function longestWord() {
        let str = longestWordText.split(" ");
        let longest = 0;
        let maxLength = 0;
        str.forEach(function (str) {
            if (longest < str.length) {
                longest = str.length;
                maxLength = longest;
            }
        });
        str.forEach(function (str) {
            if (maxLength === str.length) {
                words.push(str);
            }
        });
        console.log(words);
        getPattern();
      //  searchObj('ABCD');
    }

    function getPattern()
    {
        for(let key in words)
        {
            let pattern = [];
            let lastCharacterUsedIndex = 0;
            let word = words[key];
            let length = word.length;

            let reconstruct = '';
            console.log('WORD' , word);

            let patternString = '';

            for (let i = 0; i < length; i++)
            {
                if(reconstruct.indexOf(word.charAt(i)) > -1)
                {
                    var characterPosition = reconstruct.indexOf(word.charAt(i));
                    console.log('characterPosition' , characterPosition);
                    var character = patternString.charAt(characterPosition);
                    console.log('character' , character);
                    patternString += character;
                }
                else{
                    patternString += String.fromCharCode(lastCharacterUsedIndex + 65);
                    lastCharacterUsedIndex += 1;
                }
                reconstruct += word.charAt(i);
                console.log('patternString' , patternString);
                console.log('RECONSTRUCT' , reconstruct);
            }
        }

    }

    function searchObj (query) {

        for (var key in dictionary) {
            var value = dictionary[key];

            if (typeof value === 'object') {
                searchObj(value, query);
            }

            if (value === query) {
                console.log('property=' + key + ' value=' + value);
            }

        }

    }

</script>
</html>